function FMB_Ini(n,t,i){FBM_Load(n,ismore=0);FBM_Filluserinfo(t,i)}async function FBM_Filluserinfo(n,t){return new Promise(()=>{setTimeout(()=>{$("#fmb_conname").html(n),$("#fmb_conurl").attr("src",t)},10)})}function FBM_Load(n,t){$.ajax({url:fl_messlist.replace("{conid}",n),dataType:"json",type:"GET",data:JSON.stringify({}),contentType:"application/json; charset=utf-8","async":!0,error:function(){notiError()},success:function(n){n.messages!=undefined&&n.messages!=""&&n.messages.data!=undefined&&n.messages.data!=""&&(t==0&&$("#fbm_content").html(""),FBM_Render(n.messages.data,"fbm_content"))},beforeSend:function(){$("#fbm_wait").removeClass("d-none")},complete:function(){$("#fbm_wait").addClass("d-none")}})}async function FBM_Render(n,t){return new Promise(()=>{var r=document.getElementById(t),i;if(r!=null){if(n&&n.length>0)for(i=0;i<n.length;i++){let t=n[i],u=FBM_RenderEach(t);r.insertAdjacentHTML("beforeend",u)}FBM_Event()}})}function FBM_RenderEach(n){try{let i=n.from,t="usersend";i.id==fb_pageid&&(t="pagesend");let r=FBM_RenderEachAttach(n);return`<div class="row blocksend ${t}">
                <div class="col-auto">
                    <div class="card card-plain">
                        <div class="card-body py-2 px-3">
                            <div class=" text-dark mb-1">
                                ${r}
                            </div>
                            <div class="d-flex text-dark align-items-center text-sm opacity-6">
                                <div class="date">${ConvertDateTimeUTC(n.created_time)}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`}catch(t){return""}}function FBM_RenderEachAttach(n){if(n.message!=undefined&&n.message!="")return`<div class="content">${n.message}</div>`;if(n.sticker!=undefined&&n.sticker!="")return`<img src="${n.sticker}" class="sticker"/>`;if(n.attachments!=undefined&&n.attachments.data.length>0){let t=n.attachments.data,f=[],i="",r="",u="";for(let n=0;n<t.length;n++){let e=t[n].name!=undefined?t[n].name:"";t[n].mime_type.includes("image")?f.push(t[n]):t[n].mime_type.includes("audio")?i=i+`<div class="audio">
                                <audio controls>
                                    <source src="${t[n].file_url}" type="audio/mpeg">
                                </audio>
                            </div>`:t[n].mime_type.includes("video")?r=r+`<div class="video">
                                <video controls>
                                  <source src="${t[n].file_url}" type="video/mp4">
                                </video>
                            </div>`:u=u+`<div class="file">
                                <div class="d-flex align-items-center">
                                <i class="fas fa-arrow-circle-down pe-2 "></i>
                               <a class="cursor-pointer text-sm" href="${t[n].file_url}">${e}</a>
                               </div>
                            </div>`}return console.log(n),`<div class="media">${i}${r}${u} </div>`}return""}function FBM_Event(){}