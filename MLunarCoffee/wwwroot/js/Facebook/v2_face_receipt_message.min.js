function Face_Receipt_Message(n){let t=new Promise(()=>{Face_Receipt_Message_Action(n)})}function Face_Receipt_Message_Action(n){if(typeof face_value_total_page_string!="undefined"&&typeof face_value_total_page_string!="undefined"){let t={},h=new Date,r=new Date;r.setDate(r.getDate()-1);let u,f,e,o=JSON.parse(n).entry[0],i=o.messaging[0].message,c=i.mid,s=o.messaging[0].recipient.id;if(face_value_total_page_string.includes(s)){let n=o.messaging[0].sender.id;if(i.hasOwnProperty("attachments")){let n=i.attachments[0];u=n.type;f=n.payload.url;e="Sending image"}i.hasOwnProperty("text")&&(e=i.text,f="",u="text");t.page=s;t.client=n;t.type=u;t.message=e;t.url=f;t.created=h;t.updated=h;t.readtime=r;t.client_to_server="1";t.staff=0;t.tag="";t.servicecare="";t.discount=0;t.area=0;t.callbacktime=r;t.ticket=0;t.star=0;t.typeconver="mess";t.staffname="";t.discountname="";t.verb="";t.post_id="";t.comment_id="";let l=s+"-"+n;Face_Delivery_Message(t,l,c)}}}function Face_Delivery_Message(n,t,i){if(face_value_selected_page_string.includes(n.page))if($("#"+t).length)if(n.client==face_value_current_client&&n.page==face_value_current_page&&face_value_current_mess_post=="MESS")Face_Exchange_Move_Mess_To_Top(t),Face_Exchange_Update_Item_Update_Person_Do(t,n.client,n.type,n.message,n.url),Face_Update_Chatting(i,n.created),Face_Update_Conversation_Having_Phone(n.message,n.created);else{let i=Face_Notification_New_Message(n.client,n.page,n.message,n.url,n.type,"MESS");Face_Notification_New_Remove_FromQueure(i);Face_Notification_New_Event_Close();Face_Exchange_Move_Mess_To_Top(t);Face_Exchange_Update_Item_Update_Person_Do(t,n.client,n.type,n.message,n.url);Face_Exchange_Update_Item_Read_To_Unread(t)}else{let t=Face_Notification_New_Message(n.client,n.page,n.message,n.url,n.type,"MESS");Face_Notification_New_Remove_FromQueure(t);Face_Notification_New_Event_Close();Face_Get_Mess_In_Notification(n.page,n.client)}else Face_Notification_OtherPage(n.page)}