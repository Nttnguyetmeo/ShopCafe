function Todo_Detail_SH_WhenClose(n){n==1?($("#todo_message_input").prop("disabled",!0),$("#tododetail_send_close").show(),$("#todo_message_send").hide(),$("#tododetail_edit").hide(),$(".todo_mess_edit").hide(),$(".todo_mess_delete").hide()):($("#todo_message_input").prop("disabled",!1),$("#tododetail_send_close").hide(),$("#todo_message_send").show(),$("#tododetail_edit").show())}function Todo_Detail_Reaction_Header_Click(){$("#tododetail_reaction_a").hasClass("disabled")||$("#tododetail_reaction_a").addClass("disabled");let n='"'+sys_userID_Main+'"';Todo_Detail_Reaction_Header_Execute(n)}function Todo_Detail_Reaction_Header_Execute(n){AjaxLoad(url="/Todo/Personal/TodoDetail/?handler=Reaction_Todo",data={CurrentID:current_todo_id,userstring:n},async=!0,error=null,success=function(n){if(n!=""){let t=JSON.parse(n)[0],i=Number(t.IsReaction);i==1?$("#tododetail_reaction_icon").hasClass("liked")||$("#tododetail_reaction_icon").addClass("liked"):$("#tododetail_reaction_icon").hasClass("liked")&&$("#tododetail_reaction_icon").removeClass("liked");$("#tododetail_reaction_icon").attr("data-reaction",t.DataReaction);$("#tododetail_reaction_a").hasClass("disabled")&&$("#tododetail_reaction_a").removeClass("disabled");$("#tododetail_reaction_num").html(JSON.parse(t.DataReaction).length)}})}function Todo_Detail_Update_Read(){AjaxLoad(url="/Todo/Personal/TodoDetail/?handler=Update_Read_Todo",data={CurrentID:current_todo_id},async=!0,error=null,success=function(n){if(n!="0"){let t="todo_item_list_"+n;$("#"+t).find(".todo_item_content").length&&$("#"+t).find(".todo_item_content").hasClass("un_read")&&$("#"+t).find(".todo_item_content").removeClass("un_read");typeof MS_MessageLoad!="undefined"&&$.isFunction(MS_MessageLoad)&&MS_MessageLoad()}})}function Todo_Detail_Reaction_Message_Event(){$(".item_message_like").unbind().on("click",function(){let n=$(this).attr("data-id");$(this).hasClass("disabled")||$(this).addClass("disabled");let t='"'+sys_userID_Main+'"';Todo_Detail_Reaction_Message_Execute(t,n)});$(".todo_mess_edit").unbind().on("click",function(){let n=$(this).attr("data-id");if($("#todo_mess_content_"+n).length){let t=$("#todo_mess_content_"+n).html();$("#todo_message_input").val(t);Todo_Detail_BeginEdit(n)}});$(".todo_mess_delete").unbind().on("click",function(){let n=$(this).attr("data-id");const t=notiConfirm();t.then(function(){Todo_Detail_Message_Delete_Execute(n)},function(){})});$(".todo_mess_editinfo").popup({transition:"scale up",position:"top right"})}function Todo_Detail_Reaction_Message_Execute(n,t){AjaxLoad(url="/Todo/Personal/TodoDetail/?handler=Reaction_Message",data={messid:t,userstring:n},async=!0,error=null,success=function(n){if(n!=""){let r=JSON.parse(n)[0],u=Number(r.IsReaction),i="todo_mess_"+t,f="todo_mess_count"+t;u==1?$("#"+i).hasClass("liked")||$("#"+i).addClass("liked"):$("#"+i).hasClass("liked")&&$("#"+i).removeClass("liked");$("#"+i).attr("data-reaction",r.DataReaction);$("#"+i).hasClass("disabled")&&$("#"+i).removeClass("disabled");$("#"+f).html(JSON.parse(r.DataReaction).length)}})}function Todo_Detail_Message_Send(){let n=$("#todo_message_input").val(),t=n.split(" ").join("");t.length<1?$("#todo_message_input").hasClass("noticeMess")||$("#todo_message_input").addClass("noticeMess"):($("#todo_message_input").hasClass("disabled")||$("#todo_message_input").addClass("disabled"),$("#todo_message_input").hasClass("noticeMess")&&$("#todo_message_input").removeClass("noticeMess"),$("#todo_message_input").val(""),Todo_Detail_Message_Send_Execute(n))}function Todo_Detail_Message_Cancel(){Todo_Detail_UnEdit()}function Todo_Detail_Message_Send_Execute(n){AjaxLoad(url="/Todo/Personal/TodoDetail/?handler=Sending_Mess",data={TodoID:current_todo_id,content:n,currentid:todo_detail_current},async=!0,error=null,success=function(n){n!="0"?($("#todo_message_input").hasClass("disabled")&&$("#todo_message_input").removeClass("disabled"),ToDoDetail_LoadMessage(n),todo_detail_current==0&&TodoList_LoadData(current_todo_id,0,1),Todo_Detail_UnEdit()):(toto_detail_close=1,Todo_Detail_SH_WhenClose(toto_detail_close))})}function Todo_Detail_UnEdit(){todo_detail_current=0;$(".todo_message_item").removeClass("message_edit");$("#todo_message_cancel").hide();$("#todo_message_input").val("")}function Todo_Detail_BeginEdit(n){todo_detail_current=n;let t="todo_message_item_"+n;$(".todo_message_item").removeClass("message_edit");$("#"+t).hasClass("disabled")||$("#"+t).addClass("message_edit");$("#todo_message_cancel").show()}function Todo_Detail_Message_Delete_Execute(n){AjaxLoad(url="/Todo/Personal/TodoDetail/?handler=Delete_Mess",data={messid:n,todoID:current_todo_id},async=!0,error=null,success=function(t){t!="0"?($("#todo_message_item_"+n).length&&$("#todo_message_item_"+n).remove(),Todo_Detail_UnEdit()):(toto_detail_close=1,Todo_Detail_SH_WhenClose(toto_detail_close))})}