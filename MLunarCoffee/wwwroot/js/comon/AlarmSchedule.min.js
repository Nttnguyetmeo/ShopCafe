function setCookie(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toGMTString();document.cookie=n+"="+t+";"+u+";path=/"}function getCookie(n){var i,t;try{var r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";");for(i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}catch(e){}}function checkCookie(n){var t=getCookie(n);return t!=""&&t!=null?!0:!1}function SettingAlarm(n){if(checkCookie("SettingAlarm")){let t=JSON.parse(getCookie("SettingAlarm")),r=t.data,i=t.empID;i!=n?(DeleteAlarmCookie(),GetAlarmSchedule(1,Second_alram_count,n)):EstablishAlarmSchedule(JSON.parse(getCookie("SettingAlarm")).data,Second_alram_count)}else DeleteAlarmCookie(),GetAlarmSchedule(1,Second_alram_count,n);setInterval(function(){EstablishAlarmSchedule(JSON.parse(getCookie("SettingAlarm")).data,Second_alram_count)},Second_alram_count*1e3)}function SetAlarmSchedule(n,t,i,r){let u={empID:r,data:n};setCookie("SettingAlarm",JSON.stringify(u),t);EstablishAlarmSchedule(n,i)}function GetAlarmSchedule(n,t,i){AjaxLoad(url="/Todo/AlarmSchedule/MyAlarmScheduler_List/?handler=LoadAlarmScheduleToday",data={},async=!1,error=null,success=function(r){if(r!=""){let u=JSON.parse(r);u.length>0&&SetAlarmSchedule(u,n,t,i)}})}function EstablishAlarmSchedule(n,t){let r=new Date,u=r.getHours(),f=r.getMinutes();for(i=0;i<n.length;i++){let r=n[i],e=r.TimeAlarm.split(":"),s=Number(e[0])-Number(u),h=Number(e[1])-Number(f),o=s*3600+h*60;o<0?DeleteItemAlarmCookie(r.ID,1):o<t&&(notiMess10(r.Content),DeleteItemAlarmCookie(r.ID,1))}}function UpdateAlarmCookie(n,t){if(checkCookie("SettingAlarm")){let f=0,u=JSON.parse(n.data)[0],e=new Date;switch(u.type.toString()){case"1":let n=new Date(u.date),t=new Date(e.getFullYear()+"-"+Number(e.getMonth()+1)+"-"+e.getDate());n.toDateString()==t.toDateString()&&(f=1);break;case"2":f=1;break;case"3":var r=e.getDay();let i=u.dayofweek;r==i&&(f=1);break;case"4":e.getDate()==u.day&&(f=1)}if(f==1&&n.Status!=0){let f=JSON.parse(getCookie("SettingAlarm")),r=f.data,o=f.empID,e=1;for(i=0;i<r.length;i++)r[i].ID==n.ID&&(r[i].Title=n.Title,r[i].Content=n.Content,r[i].TimeAlarm=u.hour,e=0);if(e!=0){let t=[{ID:n.ID.toString(),Title:n.Title,Content:n.Content,TimeAlarm:u.hour}];r.push(t[0])}let s={empID:o,data:r};setCookie("SettingAlarm",JSON.stringify(s),t)}else DeleteItemAlarmCookie(n.ID,1)}else RefeshAlarmCookie(t)}function RefeshAlarmCookie(n){setCookie("SettingAlarm","",-1);GetAlarmSchedule(n)}function DeleteItemAlarmCookie(n,t){let u=JSON.parse(getCookie("SettingAlarm")),i=u.data,f=u.empID,r=-1;if(i.length>0&&i!=null){for(j=0;j<i.length;j++)if(i[j].ID==n){r=j;break}if(r!=-1){i.splice(r,1);let n={empID:f,data:i};setCookie("SettingAlarm",JSON.stringify(n),t)}}}function DeleteAlarmCookie(){setCookie("SettingAlarm","",-1)}var Second_alram_count=20;