function FBR_ReceiptMess(n){let f=n.converid,i=n.fromid,o=n.icon,t=n.body,e=n.pageid,h=n.title,s=n.mid,r=n.fromname,u=n.frompicture;fb_pageid==e?$("#con"+f).length?(FBR_ChangeConver(i),FBR_ChangeContent(i,o,t),fb_userid==i?FBR_LoadReceip(s):FBR_Notinew(r,u,t)):(FBC_Load(_converid=f,_isloadmore=0,_search="",_tag=0),FBR_Notinew(r,u,t)):(FBR_ShowSignnoti(e),FBR_Notinew(r,u,t))}function FBR_ShowSignnoti(n){$("#pr"+n).addClass("unread");$("#fb_pageunreadcount").addClass("newmess")}async function FBR_ChangeConver(n){return new Promise(()=>{$(".from"+n).prependTo("#fbc_list"),$(".from"+n).addClass("unread")})}async function FBR_ChangeContent(n,t,i){return new Promise(()=>{i!=""?$(".snip"+n).html(i):$(".snip"+n).html("Gửi file"),$(".psend"+n).addClass("d-none")})}async function FBR_LoadReceip(n){return new Promise(()=>{$.ajax({url:fl_messdetail.replace("{messid}",n),dataType:"json",type:"GET",data:JSON.stringify({}),contentType:"application/json; charset=utf-8","async":!0,error:function(){},success:function(n){document.getElementById("fbm_content").insertAdjacentHTML("beforeEnd",FBM_RenderEach(n,temp=0));FBM_Scroll("bottom")}})})}async function FBR_Notinew(n,t,i){return new Promise(()=>{let r=FBR_Randomid(),f=`<div id="noti_${r}" class="alertfade alert alert-dark mt-2 text-sm alert-dismissible p-2 mb-0 text-white" role="alert">
                <button type="button" class="btn-close text-lg opacity-10 p-1" data-bs-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
                <div class="d-flex align-items-center me-4">
                    <img src=${t} class="avatar avatar-sm me-2"/>
                    <div class="">
                        <div class="twoline  fw-bolder">
                            ${n}
                        </div>
                        <div class="twoline">
                            ${i}
                        </div>
                    </div>
                </div>
                
            </div>`;$("#fb_receiparea").html($("#fb_receiparea").html()+f);let u=$("#fb_receiparea .alert");u!=undefined&&u.length>1&&$("#fb_receiparea").find("div:first").remove();FBR_Closenew(r);setTimeout(()=>{$(`#noti_${r}`).removeClass("alertfade")},1e3)})}async function FBR_Closenew(n){return new Promise(()=>{setTimeout(()=>{$("#noti_"+n).remove()},1e4)})}function FBR_Randomid(){return Math.floor(Math.random()*100001).toString()+"-"+(new Date).getTime().toString()}