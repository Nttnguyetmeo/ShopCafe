var Notier=Notier||{};(function(){function o(n){this.$options=null;var t=this,i=function(){t.$options.Receivers&&t.$options.Receivers.length>0&&$.ajax({url:"/Api/Notier",dataType:"json",type:"POST",data:JSON.stringify(t.$options),contentType:"application/json; charset=utf-8","async":!0,error:function(){},success:function(){}})};this.$options=n;i()}function u(n){this.options=null;var t=this,i=function(){Lobibox.notify("success",{size:"normal",rounded:!1,delayIndicator:!0,msg:t.$options.Content,closeOnClick:function(){window.open(t.$options.Link,"_blank")},title:t.$options.Title,soundPath:"/assests/dist/plugins/lobibox/sounds/",soundExt:".ogg",sound:t.$options.Sound,showClass:"fadeInDown",hideClass:"zoomOut",delay:5e3})};this.$options=n;i()}function f(n){var t=[];let r=new Date,f=r.getHours(),e=r.getMinutes();for(i=0;i<n.length;i++){let r=n[i],o=r.Time.split(":"),h=Number(o[0])-Number(f),c=Number(o[1])-Number(e),s=h*3600+c*60;s<0||(s<Notier.Second?new u(r):t.push(r))}return t}function n(n){if(n.Time&&n.Time!=""){let u=JSON.parse(t("listNoti")),i=[];u.data.length>0&&(i=u.data);i.push(n);let f={empID:Notier.ElmID,data:i};r("listNoti",JSON.stringify(f),1)}else new u(n)}Notier.Second=20;Notier.Interval=null;Notier.ElmID="";Notier.BranchID="";Notier.Defaults={Title:"",Content:"",Link:"",Time:null,Date:new Date,Receivers:[],Sender:"",Branchs:[]};Notier.notify=function(t,i){var r=function(t){var r,i;t.Receivers&&t.Receivers.length>0?(r=t.Receivers.filter(n=>n.ID==Notier.ElmID),r.length>0&&(t.Branchs&&t.Branchs.length>0?(i=t.Branchs.filter(n=>n.ID==Notier.BranchID),i.length>0&&n(t)):n(t))):t.Branchs&&t.Branchs.lenght>0?(i=t.Branchs.filter(n=>n.ID==this.BranchID),i.length>0&&n(t)):n(t)};t==1?new o(i):r(i)};Notier.Init=function(n,t){this.ElmID=n;this.BranchID=t;this.Interval&&clearInterval(this.Interval);this.Interval=setInterval(function(){e()},this.Second*1e3);e()};var e=function(){let n=null;if(s("listNoti")&&JSON.parse(t("listNoti")).empID==Notier.ElmID){let i=JSON.parse(t("listNoti")).data,u=new f(i);n={empID:Notier.ElmID,data:u};r("listNoti",JSON.stringify(n),1)}else $.ajax({url:"/Api/Notier/GetNoti?ID="+Notier.ElmID,dataType:"json",type:"GET",contentType:"application/json; charset=utf-8","async":!0,error:function(){},success:function(t){if(t!=""){let i=t,u=new f(JSON.parse(i));n={empID:Notier.ElmID,data:u};r("listNoti",JSON.stringify(n),1)}}})},s=function(n){var t=getCookie(n);return t!=""&&t!=null?!0:!1},t=function(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""},r=function(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toGMTString();document.cookie=n+"="+t+";"+u+";path=/"}})();